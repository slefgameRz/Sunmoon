# LINE Official Account Integration Guide

## ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°
SEAPALO ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö LINE Official Account ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡πâ‡∏≥‡∏Ç‡∏∂‡πâ‡∏ô‡∏ô‡πâ‡∏≥‡∏•‡∏á‡∏ú‡πà‡∏≤‡∏ô LINE ‡πÑ‡∏î‡πâ

## ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ LINE Official Account

### 1. ‡∏™‡∏£‡πâ‡∏≤‡∏á LINE Official Account
1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà [LINE Developers Console](https://developers.line.biz/console/)
2. ‡∏™‡∏£‡πâ‡∏≤‡∏á Provider (‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ)
3. ‡∏™‡∏£‡πâ‡∏≤‡∏á Messaging API Channel
4. ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:
   - Channel name: SEAPALO
   - Channel description: ‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå‡∏ô‡πâ‡∏≥‡∏Ç‡∏∂‡πâ‡∏ô‡∏ô‡πâ‡∏≥‡∏•‡∏á
   - Category: ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°

### 2. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Webhook
1. ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ Messaging API settings
2. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏™‡πà‡∏ß‡∏ô Webhook settings
3. ‡∏ï‡∏±‡πâ‡∏á Webhook URL: `https://your-domain.com/api/webhook/line`
4. ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô "Use webhook"
5. Verify ‡∏ß‡πà‡∏≤ webhook ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ

### 3. ‡∏î‡∏∂‡∏á Credentials
1. ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ Basic settings
   - ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å **Channel Secret**
2. ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ Messaging API
   - ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å **Channel Access Token** (Long-lived)
   - ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ ‡πÉ‡∏´‡πâ‡∏Å‡∏î "Issue" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á

### 4. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Environment Variables
1. ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å `.env.example` ‡πÄ‡∏õ‡πá‡∏ô `.env.local`
2. ‡πÄ‡∏û‡∏¥‡πà‡∏° credentials:
```bash
LINE_CHANNEL_ACCESS_TOKEN=your_channel_access_token_here
LINE_CHANNEL_SECRET=your_channel_secret_here
```

### 5. Deploy ‡πÅ‡∏•‡∏∞‡∏ó‡∏î‡∏™‡∏≠‡∏ö
1. Deploy application ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì (‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ HTTPS)
2. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Webhook URL ‡πÉ‡∏ô LINE Console
3. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö webhook ‡πÉ‡∏ô LINE Console

## ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

### ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö

#### 1. ‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà
‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà:
- `‡∏†‡∏π‡πÄ‡∏Å‡πá‡∏ï`
- `‡∏û‡∏±‡∏ó‡∏¢‡∏≤`
- `‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û`
- `‡∏™‡∏°‡∏∏‡∏¢`
- `‡∏´‡∏±‡∏ß‡∏´‡∏¥‡∏ô`

#### 2. ‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡∏û‡∏¥‡∏Å‡∏±‡∏î
‡∏û‡∏¥‡∏°‡∏û‡πå‡∏û‡∏¥‡∏Å‡∏±‡∏î‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö lat,lon:
- `13.7563, 100.5018`
- `7.8804, 98.3923`

#### 3. ‡∏Ç‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠
‡∏û‡∏¥‡∏°‡∏û‡πå:
- `help`
- `‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠`
- `?`

### ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö

#### ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡πâ‡∏≥‡∏Ç‡∏∂‡πâ‡∏ô‡∏•‡∏á
```
üåä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡πâ‡∏≥‡∏Ç‡∏∂‡πâ‡∏ô-‡∏ô‡πâ‡∏≥‡∏•‡∏á: ‡∏†‡∏π‡πÄ‡∏Å‡πá‡∏ï

üìà ‡∏ô‡πâ‡∏≥‡∏Ç‡∏∂‡πâ‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î: 14:30 ‡∏ô.
üìâ ‡∏ô‡πâ‡∏≥‡∏•‡∏á‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î: 08:15 ‡∏ô.

üíß ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô: 1.23 ‡∏°.
üìä ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏ô‡πâ‡∏≥‡∏Ç‡∏∂‡πâ‡∏ô

üåô ‡∏ô‡πâ‡∏≥‡πÄ‡∏õ‡πá‡∏ô (12 ‡∏Ç‡∏∂‡πâ‡∏ô)

‚öì ‡∏ó‡πà‡∏≤‡πÄ‡∏£‡∏∑‡∏≠‡πÉ‡∏Å‡∏•‡πâ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î: ‡∏ó‡πà‡∏≤‡πÄ‡∏£‡∏∑‡∏≠‡∏†‡∏π‡πÄ‡∏Å‡πá‡∏ï (2.5 ‡∏Å‡∏°.)

‚è∞ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï: 14:30:45
```

## API Endpoints

### GET /api/webhook/line
Health check endpoint
```bash
curl https://your-domain.com/api/webhook/line
```

Response:
```json
{
  "status": "ok",
  "service": "LINE Webhook",
  "timestamp": "2025-10-23T10:30:00.000Z"
}
```

### POST /api/webhook/line
Webhook endpoint ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏±‡∏ö events ‡∏à‡∏≤‡∏Å LINE
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö signature
- ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
- ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡πâ‡∏≥‡∏Ç‡∏∂‡πâ‡∏ô‡∏•‡∏á‡∏Å‡∏•‡∏±‡∏ö

## ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö

### ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Webhook ‡∏î‡πâ‡∏ß‡∏¢ LINE Console
1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà Messaging API settings
2. ‡∏Ñ‡∏•‡∏¥‡∏Å "Verify" ‡πÉ‡∏ô Webhook URL
3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÑ‡∏î‡πâ response 200 OK

### ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
1. Scan QR Code ‡∏Ç‡∏≠‡∏á LINE OA
2. Add ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô
3. ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏î‡∏™‡∏≠‡∏ö ‡πÄ‡∏ä‡πà‡∏ô "‡∏†‡∏π‡πÄ‡∏Å‡πá‡∏ï"
4. ‡∏£‡∏≠‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡πâ‡∏≥‡∏Ç‡∏∂‡πâ‡∏ô‡∏•‡∏á

### ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢ curl (development)
```bash
# Test health check
curl https://your-domain.com/api/webhook/line

# Test webhook (‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ valid signature)
curl -X POST https://your-domain.com/api/webhook/line \
  -H "Content-Type: application/json" \
  -H "x-line-signature: YOUR_SIGNATURE" \
  -d '{
    "events": [{
      "type": "message",
      "message": {
        "type": "text",
        "text": "‡∏†‡∏π‡πÄ‡∏Å‡πá‡∏ï"
      },
      "replyToken": "test_token",
      "source": {
        "userId": "test_user"
      }
    }]
  }'
```

## Security

### Signature Verification
Webhook ‡∏à‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö signature ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢:
- ‡πÉ‡∏ä‡πâ HMAC-SHA256
- ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö `x-line-signature` header
- ‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò request ‡∏ó‡∏µ‡πà signature ‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô

### Best Practices
1. ‡πÉ‡∏ä‡πâ HTTPS ‡πÄ‡∏™‡∏°‡∏≠
2. ‡πÄ‡∏Å‡πá‡∏ö Channel Secret ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢
3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö signature ‡∏ó‡∏∏‡∏Å request
4. ‡∏à‡∏≥‡∏Å‡∏±‡∏î rate limiting ‡∏ñ‡πâ‡∏≤‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô

## Troubleshooting

### Webhook ‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ URL ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (HTTPS)
2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö environment variables
3. ‡∏î‡∏π logs ‡πÉ‡∏ô console
4. Verify webhook ‡πÉ‡∏ô LINE Console

### ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Channel Access Token
2. ‡∏î‡∏π error logs
3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ replyToken ‡∏¢‡∏±‡∏á‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ
4. replyToken ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 1 ‡∏ô‡∏≤‡∏ó‡∏µ

### Error: Invalid signature
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö LINE_CHANNEL_SECRET ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç request body
3. ‡πÉ‡∏ä‡πâ raw body ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì signature

## Features

### ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
- ‚úÖ ‡∏£‡∏±‡∏ö-‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° text
- ‚úÖ ‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå‡∏ô‡πâ‡∏≥‡∏Ç‡∏∂‡πâ‡∏ô‡∏•‡∏á‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà
- ‚úÖ ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©
- ‚úÖ ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡πà‡∏≤‡πÄ‡∏£‡∏∑‡∏≠‡πÉ‡∏Å‡∏•‡πâ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î
- ‚úÖ Health check endpoint

### ‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï
- üîÑ Scheduled updates (‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ó‡∏∏‡∏Å 2 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á)
- üîÑ Rich messages (Flex Message)
- üîÑ Quick Reply buttons
- üîÑ Location sharing
- üîÑ Notification settings

## Support

‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°:
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö logs ‡πÉ‡∏ô console
2. ‡∏≠‡πà‡∏≤‡∏ô [LINE Messaging API Documentation](https://developers.line.biz/en/docs/messaging-api/)
3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö [LINE API Reference](https://developers.line.biz/en/reference/messaging-api/)
